
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>ع طريقك API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;http&quot;,&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="http">http</a>
              <a href="#" data-language-name="shell">shell</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#including-relationships" class="toc-h1 toc-link" data-title="Including Relationships">Including Relationships</a>
          </li>
          <li>
            <a href="#selecting-fields" class="toc-h1 toc-link" data-title="Selecting Fields">Selecting Fields</a>
          </li>
          <li>
            <a href="#filtering" class="toc-h1 toc-link" data-title="Filtering">Filtering</a>
          </li>
          <li>
            <a href="#ordering" class="toc-h1 toc-link" data-title="Ordering">Ordering</a>
          </li>
          <li>
            <a href="#verify" class="toc-h1 toc-link" data-title="Verify">Verify</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#start" class="toc-h2 toc-link" data-title="start">start</a>
                  </li>
                  <li>
                    <a href="#verify-2" class="toc-h2 toc-link" data-title="verify">verify</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#connect" class="toc-h1 toc-link" data-title="Connect">Connect</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#connect-2" class="toc-h2 toc-link" data-title="connect">connect</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#profile-update" class="toc-h1 toc-link" data-title="Profile Update">Profile Update</a>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>All results of API calls are <a href='http://jsonapi.org/format'>JSON API</a> compliant JSON. Except for a few simple requests that return simple JSON objects.</p>
<h1 id='including-relationships'>Including Relationships</h1>
<p>You can include resource relationships and their nested relationships to minimize the number of API calls.</p>

<p>Example:</p>

<p>You can include a trip&#39;s driver when listing trips or when showing a specific trip by
  using the <code>include</code> param like this:</p>

<p><code>?include[]=driver</code></p>

<p>You can also include the driver&#39;s car (nested relationship):</p>

<p><code>?include[]=driver.car</code></p>

<p><aside class="success">
    Including a nested relationship automatically includes its parent.</p>

<p>i.e:
      <code>?include[]=driver.car</code> includes the driver so you do not need to ?include[]=driver
  </aside></p>

<p><aside class="success">
    Each resource section will include a list of relationships that you can include with it.
  </aside></p>

<p><aside class="warning">
    You can pass params with multiple values by appending the param name with brackets <code>[]</code>:</p>

<p>RIGHT: ?include[]=driver&amp;include[]=driver.car</p>

<p>WRONG: ?include=driver,driver.car
  </aside></p>
<h1 id='selecting-fields'>Selecting Fields</h1>
<p>You can select only the fields that you are interested in from the main resource and the included relationships.</p>

<p>Example:</p>

<p>When listing trips, you maybe only interested in a trip&#39;s <code>cost</code> and <code>seats</code>. You can pass the fields param to
  select them like this:</p>

<p><code>?fields[trip][]=cost&amp;fields[trip][]=seats</code></p>

<p>Where <code>trip</code> (in <code>fields[trip]</code>) is the singular, lowercase name of the resource type. (So it is <code>trip</code>, not <code>trips</code> nor <code>Trip</code>)</p>

<p>If you have included the <code>car</code> relationship, then you can select its fields like this:</p>

<p><code>?fields[trip][]=cost&amp;fields[trip][]=seats&amp;fields[car][]=make&amp;fields[car][]=model</code></p>

<p><aside class="success">
    Each resource section will include a list of fields that can be selected, along with the authorization level required to access different fields if authorization is required.
  </aside></p>

<p><aside class="warning">
    The resource type name can different from a relationship&#39;s or an attribute&#39;s name. For example, a <code>trip</code> has two relationships of type <code>User</code>, <code>driver</code> and <code>passengers</code>.</p>

<p>And you can only use the resource type name with the fields param. This means that the following params are invalid and will be ignored:</p>

<p><code>?fields[driver][]=first_name&amp;fields[passenger][]=first_name</code></p>

<p>The correct way to select driver and passenger fields is:</p>

<p><code>?fields[user][]=first_name</code></p>

<p>This also means that you can&#39;t select a different set of fields for each of the driver and the passengers relationships since the are of the same type.
  </aside></p>
<h1 id='filtering'>Filtering</h1>
<p>You can use predefined resource filters that will be listed in the resource section.</p>

<p>Example:</p>

<p>To list only active trips: <code>/trips?status=active</code> OR <code>/trips?status[]=active</code></p>

<p>To list active or pending trips: <code>/trips?status[]=active&amp;status[]=pending</code></p>
<h1 id='ordering'>Ordering</h1>
<p>Example:</p>

<p>Order trips by cost, ascending: <code>?order[]=cost&amp;sort_order=asc</code></p>

<p>Order trips by cost, then by id, descending: <code>order[]=cost&amp;order[]=id&amp;sort_order=desc</code></p>
<h1 id='verify'>Verify</h1>
<p>First, <code>start</code> the verification process to obtain a verification token. Then <code>verify</code> using the token you received.</p>
<h2 id='start'>start</h2>
<blockquote>
<p>1.start: Obtain a verification code:</p>
</blockquote>
<pre class="highlight http tab-http"><code><span class="err">  POST /users/verification/start
  Content-Type: application/json
  {
    "phone": "+201061797840"
  }
</span></code></pre><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</code></pre>
<p>Endpoint</p>

<p><code>POST /users/verification/start</code></p>

<p>Response</p>

<p><code>Empty</code></p>

<p>Errors</p>

<table><thead>
<tr>
<th>Status</th>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>422</td>
<td>invalid_data</td>
<td>phone is missing or invalid</td>
</tr>
<tr>
<td>500</td>
<td>sending_verification_failed</td>
<td>Verification service failed</td>
</tr>
</tbody></table>
<h2 id='verify-2'>verify</h2>
<blockquote>
<p>2.verify: verify phone with the verification code you received.</p>
</blockquote>
<pre class="highlight http tab-http"><code><span class="err">  POST /users/verification/verify
  Content-Type: application/json
  {
    "phone": "+201061797840"
    "verification_code": "1234"
  }
</span></code></pre><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"message"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Verification code is correct."</span><span class="p">,</span><span class="w">
    </span><span class="s2">"success"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"verification_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RJdBcCVdXDzKZvrigMNUlw"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Endpoint</p>

<p><code>POST /users/verification/verify</code></p>

<p>Response</p>

<p><code>verification_token</code>: A token that you will need to login or sign up.</p>

<p>Errors</p>

<table><thead>
<tr>
<th>Status</th>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>422</td>
<td>invalid_data</td>
<td>phone is missing or invalid</td>
</tr>
<tr>
<td>422</td>
<td>verification_failed</td>
<td>verification_code is invalid or has expired</td>
</tr>
<tr>
<td>422</td>
<td>missing_data</td>
<td>verification_code is missing</td>
</tr>
</tbody></table>
<h1 id='connect'>Connect</h1>
<p>A single endpoint to register or sign in a user with only a phone number. You will also need to provide the verification_token acquired in <code>Verify</code></p>
<h2 id='connect-2'>connect</h2><pre class="highlight http tab-http"><code><span class="err">  POST /users/verification/start
  Content-Type: application/json
  {
    "phone": "+201061797840"
  }
</span></code></pre><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"John"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Smith"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"birthdate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1988-09-13"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"uid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+201061797842"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"spare_phone"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+201061797842"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"female"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"balance"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="s2">"verified_user"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"verified_driver"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"identity_verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"phone_verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"profile_complete"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-08-30T23:03:58.999Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-10-14T01:23:51.355Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"trips_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="s2">"tickets_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="s2">"notes"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"new_user"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"rating_avg"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"picture_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.com/rails/active_storage/blobs/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBFdz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--57e37815432b95f9896bace14d114a2810797f29/user2.jpg"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id_picture_one_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id_picture_two_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dl_picture_one_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dl_picture_two_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"relationships"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"addresses"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"36"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"address"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"cars"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"16"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>The <code>verification_token</code> expires in 5 minutes.</p>

<p>If <code>connect</code> request fails (due to an expired or incorrect verification_token), the application needs to start the verification process again.</p>

<p>Endpoint</p>

<p><code>POST /connect</code></p>

<p>Errors</p>

<table><thead>
<tr>
<th>Status</th>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>422</td>
<td>invalid_data</td>
<td>invalid phone or verification_token</td>
</tr>
<tr>
<td>422</td>
<td>phone_taken</td>
<td>Phone number is taken. This can very rarely happen if for example th same user sent two request in quick succession.</td>
</tr>
</tbody></table>
<h1 id='profile-update'>Profile Update</h1>
<p>All of user&#39;s profile attributes are optional. Some become required and will be validated if the <code>profile_complete</code> boolean attribute is set to true.</p>
<pre class="highlight http tab-http"><code><span class="err">  PUT /user
  Content-Type: application/json
</span></code></pre><pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"addresses_attributes"</span><span class="p">:{</span><span class="s2">"0"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"city"</span><span class="p">:</span><span class="s2">"c1"</span><span class="p">,</span><span class="s2">"location"</span><span class="p">:</span><span class="s2">"l1"</span><span class="p">},</span><span class="w"> </span><span class="s2">"1"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c2"</span><span class="p">,</span><span class="s2">"location"</span><span class="p">:</span><span class="s2">"l2"</span><span class="p">}},</span><span class="w">
    </span><span class="s2">"birthdate"</span><span class="p">:</span><span class="s2">"1988-09-13 00:00:00"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"first_name"</span><span class="p">:</span><span class="s2">"a name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"last_name"</span><span class="p">:</span><span class="s2">"a last name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"female"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"profile_complete"</span><span class="p">:</span><span class="s2">"true"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight http tab-http"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
</code></pre><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"23"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"first_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a name"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"last_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a last name"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"birthdate"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1988-09-13"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"uid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+201061797842"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"spare_phone"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"+201061797842"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"gender"</span><span class="p">:</span><span class="w"> </span><span class="s2">"female"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"balance"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="s2">"verified_user"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"verified_driver"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"identity_verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"phone_verified"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"profile_complete"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
            </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-08-30T23:03:58.999Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"updated_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-10-15T00:37:23.237Z"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"trips_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="s2">"tickets_count"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="s2">"notes"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"new_user"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
            </span><span class="s2">"rating_avg"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"picture_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:3000/rails/active_storage/blobs/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBFdz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--57e37815432b95f9896bace14d114a2810797f29/user2.jpg"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id_picture_one_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id_picture_two_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dl_picture_one_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="s2">"dl_picture_two_url"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"relationships"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"addresses"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"31"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"address"</span><span class="w">
                    </span><span class="p">},</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"64"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"address"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"cars"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                    </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"16"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"car"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"included"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"31"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"address"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c1"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"l1"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">33.5014498</span><span class="p">,</span><span class="w">
                </span><span class="s2">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">36.2468128</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"relationships"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"super_address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"10"</span><span class="p">,</span><span class="w">
                      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"super_address"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"64"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"address"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"city"</span><span class="p">:</span><span class="w"> </span><span class="s2">"c2"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"l2"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
                </span><span class="s2">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="s2">"relationships"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"super_address"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                        </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"31"</span><span class="p">,</span><span class="w">
                        </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"super_address"</span><span class="w">
                    </span><span class="p">}</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Endpoint</p>

<p>put /api/user</p>

<p>User Profile Attributes</p>

<table><thead>
<tr>
<th>attribute</th>
<th>type</th>
<th>required</th>
</tr>
</thead><tbody>
<tr>
<td>birthdate</td>
<td>date</td>
<td>false</td>
</tr>
<tr>
<td>first_name</td>
<td>string</td>
<td>if profile_complete is true</td>
</tr>
<tr>
<td>last_name</td>
<td>string</td>
<td>if profile_complete is true</td>
</tr>
<tr>
<td>phone</td>
<td>string</td>
<td>true</td>
</tr>
<tr>
<td>gender</td>
<td>string [male, female]</td>
<td>false</td>
</tr>
<tr>
<td>spare_phone</td>
<td>string</td>
<td>false</td>
</tr>
<tr>
<td>profile_complete</td>
<td>boolean</td>
<td>false</td>
</tr>
<tr>
<td>addresses</td>
<td>nested attribute</td>
<td>at least 1 address if profile_complete is true</td>
</tr>
</tbody></table>

<p>Nested Attributes</p>

<p>Address
  You can update a user&#39;s associated addresses by including the <code>addresses_attributes</code> param with the user update params like this:</p>

<p><code>json
{ addresses_attributes: { &quot;0&quot;: { &quot;city&quot;: &quot;...&quot;, &quot;location&quot;: &#39;...&#39; } } }
</code></p>

<ul>
<li>Adding an address (or many addresses) to user&#39;s addresses</li>
</ul>

<p>The following will add 2 addresses to the user addresses list:</p>

<p><code>http
put /api/user
</code></p>

<p><code>json
{
  addresses_attributes: {
    &quot;0&quot;: { &quot;city&quot;: &quot;c1&quot;, &quot;location&quot;: &#39;l1&#39; },
    &quot;1&quot;: { &quot;city&quot;: &quot;c2&quot;, &quot;location&quot;: &#39;l2&#39; }
  }
}
</code></p>

<ul>
<li>Updating an address (or many addresses)</li>
</ul>

<p>To update an existing address, add the address <code>id</code> with its new attribute values like this:</p>

<p><code>http
put /api/user
</code></p>

<p><code>json
{
  addresses_attributes: {
    &quot;0&quot;: { &quot;id&quot;: &quot;1&quot;, &quot;city&quot;: &quot;new city&quot;, &quot;location&quot;: &#39;new location&#39; },
    &quot;1&quot;: { &quot;id&quot;: &quot;2&quot;, &quot;city&quot;: &quot;new city&quot;, &quot;location&quot;: &#39;new location&#39; },
  }
}
</code></p>

<ul>
<li>Removing an address (or many addresses)</li>
</ul>

<p>To remove an address, add the address <code>id</code> with the <code>_destroy</code> params like this:</p>

<p><code>http
put /api/user
</code></p>

<p><code>json
{
  addresses_attributes: {
    &quot;0&quot;: { &quot;id&quot;: &quot;1&quot;, &quot;_destroy&quot;: &quot;true&quot; }
  }
}
</code></p>

<p>Errors</p>

<table><thead>
<tr>
<th>Status</th>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>404</td>
<td>record_not_found</td>
<td><code>addresses_attributes</code> has an object with an <code>id</code> that does not point to an address that the user has.</td>
</tr>
</tbody></table>

<p>Validations &amp; Errors</p>

<p>Attribute Validations:</p>

<ol>
<li><p>spare_phone: should be a valid phone and unique if present</p></li>
<li><p>birthdate: on or before thirteen years ago if present</p></li>
<li><p>first_name, last_name: required if profile_complete. Should be less than 30 chars if present</p></li>
<li><p>addresses: user should have at least one address if profile_complete is true</p></li>
</ol>
<h1 id='errors'>Errors</h1>
<aside class="notice">
This error section is stored in a separate file in <code>includes/_errors.md</code>. Slate allows you to optionally separate out your docs into many files...just save them to the <code>includes</code> folder and add them to the top of your <code>index.md</code>'s frontmatter. Files are included in the order listed.
</aside>

<p>The Kittn API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request is invalid.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized -- Your API key is wrong.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden -- The kitten requested is hidden for administrators only.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified kitten could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed -- You tried to access a kitten with an invalid method.</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable -- You requested a format that isn&#39;t json.</td>
</tr>
<tr>
<td>410</td>
<td>Gone -- The kitten requested has been removed from our servers.</td>
</tr>
<tr>
<td>418</td>
<td>I&#39;m a teapot.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests -- You&#39;re requesting too many kittens! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable -- We&#39;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="http">http</a>
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
